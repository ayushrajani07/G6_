{# Wave 4 PoC: prefer enveloped footer_panel if supplied; fallback to snapshot.footer #}
{% set footer_data = (footer_panel.footer if footer_panel and footer_panel.footer else (snapshot.footer if snapshot else None)) %}
{% if footer_data %}
<div class="footer-bar">
  {% set total_legs = footer_data.get('total_legs') %}
  {% set overall_success = footer_data.get('overall_success') %}
  {% set indices = footer_data.get('indices') %}
  <span>Total Legs: <strong>{{ total_legs if total_legs is not none else '-' }}</strong></span>
  <span>Overall Success %: <strong>{{ '%.1f' % overall_success if overall_success is not none else '-' }}</strong></span>
  <span>Indices: <strong>{{ indices if indices is not none else '-' }}</strong></span>
  {% if snapshot %}<span>Snapshot Age: {{ '%.1f' % snapshot.age_seconds }}s {% if snapshot.stale %}<span class="stale">STALE</span>{% endif %}</span>{% endif %}
</div>
{% endif %}
